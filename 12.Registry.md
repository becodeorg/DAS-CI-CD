# Le registry docker 

On créé le certificat pour registry

```
cd /etc/gitlab
sudo openssl req   -newkey rsa:4096 -nodes -sha256 -keyout registry.das.becode.key  -addext "subjectAltName = DNS:registry.das.becode" -x509 -days 365 -out registry.das.becode.cert
```

Il faut modifer le fichier de config de gitlab 
```
sudo nano /etc/gitlab/gitlab.rb
```
Et rajouter ces lignes 

```
gitlab_rails['gitlab_default_projects_features_container_registry'] = true

registry_external_url 'https://registry.das.becode'
gitlab_rails['registry_enabled'] = true
gitlab_rails['registry_host'] = "registry.das.becode"
registry_nginx['enable'] = true
registry_nginx['listen_port'] = 443
registry_nginx['ssl_certificate'] = "/etc/gitlab/registry.das.becode.cert"
registry_nginx['ssl_certificate_key'] = "/etc/gitlab/registry.das.becode.key"
```
